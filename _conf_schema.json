{
    "pipeline": {
        "description": "管道配置",
        "type": "object",
        "hint": "管道配置，用于配置组件的启停和运行顺序",
        "items": {
            "lock_order": {
                "description": "锁定顺序",
                "hint": "锁定后将按内置顺序执行：图片外显 → 报错处理 → 消息拦截 → 解析艾特 → 文本清洗 → 文本替换 → 文转语音 → 文转图片 → 智能引用 → 合并转发 → 自动撤回 → 分段回复",
                "type": "bool",
                "default": true
            },
            "steps": {
                "description": "启用的步骤",
                "hint": "勾选表示启用该步骤；未锁定顺序时，将按当前列表顺序执行",
                "type": "list",
                "options": [
                    "summary(图片外显)",
                    "error(报错处理)",
                    "block(消息拦截)",
                    "at(解析艾特)",
                    "clean(文本清洗)",
                    "replace(文本替换)",
                    "tts(文转语音)",
                    "t2i(文转图片)",
                    "reply(智能引用)",
                    "forward(合并转发)",
                    "recall(自动撤回)",
                    "split(分段回复)"
                ],
                "default": [
                    "summary(图片外显)",
                    "error(报错处理)",
                    "block(消息拦截)",
                    "at(解析艾特)",
                    "clean(文本清洗)",
                    "replace(文本替换)",
                    "tts(文转语音)",
                    "t2i(文转图片)",
                    "reply(智能引用)",
                    "forward(合并转发)",
                    "recall(自动撤回)",
                    "split(分段回复)"
                ]
            },
            "llm_steps": {
                "description": "仅作用于 LLM 回复的步骤",
                "hint": "勾选后，该步骤仅在 LLM 回复时生效，普通插件消息不会经过该步骤",
                "type": "list",
                "options": [
                    "summary(图片外显)",
                    "error(报错处理)",
                    "block(消息拦截)",
                    "at(解析艾特)",
                    "clean(文本清洗)",
                    "replace(文本替换)",
                    "tts(文转语音)",
                    "t2i(文转图片)",
                    "reply(智能引用)",
                    "forward(合并转发)",
                    "recall(自动撤回)",
                    "split(分段回复)"
                ],
                "default": [
                    "block(消息拦截)",
                    "at(解析艾特)",
                    "clean(文本清洗)",
                    "replace(文本替换)",
                    "tts(文转语音)",
                    "reply(智能引用)",
                    "split(分段回复)"
                ]
            }
        }
    },
    "summary": {
        "description": "【图片外显】",
        "hint": "对单张图片的消息插入外显金句。外显指的是：正常的QQ没点进群聊前，若群聊发了一张图片，你只会在外面看见“[图片]”, 而图片外显功能就是为了让 “[图片]” 两字显示成更丰富的文本（仅aiocqhttp平台可用）",
        "type": "object",
        "items": {
            "quotes": {
                "description": "默认图片外显金句",
                "hint": "随机抽取一句金句给图片外显使用。请自行添加",
                "type": "list",
                "default": [
                    "你已被移出群聊",
                    "[群主女装图]",
                    "哎呦，你干嘛~",
                    "Ciallo～(∠・ω< )⌒☆"
                ]
            },
            "quotes_files": {
                "description": "金句文件路径",
                "hint": "可自行打开文件添加金句。支持相对路径和绝对路径，请用 / 拼接路径。支持填写多个路径，所有金句会整合在一起(包括默认金句)，随机抽取一句进行外显",
                "type": "list",
                "default": [
                    "data/plugins/astrbot_plugin_outputpro/default_quotes.json"
                ]
            }
        }
    },
    "error": {
        "description": "【报错处理】",
        "type": "object",
        "hint": "全局拦截报错",
        "items": {
            "keywords": {
                "description": "检测报错所用关键词",
                "hint": "Bot发的消息中，包含列表中任一关键字时，消息将被拦截",
                "type": "list",
                "default": [
                    "请求失败",
                    "出现异常"
                ]
            },
            "custom_msg": {
                "description": "原对话的消息",
                "hint": "当报错被拦截时，会在原对话中发送此消息。留空则不发送",
                "type": "string",
                "default": ""
            },
            "forward_umo": {
                "description": "转发的会话ID",
                "hint": "将报错信息转发到此会话，用 sid 命令可查看当前会话的ID。填 admin 则转发给配置中的所有 Bot 管理员, 留空则不转发",
                "type": "string",
                "default": "admin"
            }
        }
    },
    "block": {
        "description": "【消息拦截】",
        "type": "object",
        "hint": "根据各种条件对消息进行拦截",
        "items": {
            "timeout": {
                "description": "超时拦截秒数",
                "hint": "如果Bot回复时间超过此阈值(单位为秒)，则判定为超时，并拦截回复的消息。(有时LLM响应较慢，bot总是回复一段时间之前的消息, 此时超时拦截可改善此情况)",
                "type": "int",
                "slider": {
                    "min": 0,
                    "max": 120,
                    "step": 1
                },
                "default": 0
            },
            "block_reread": {
                "description": "拦截流口水的消息",
                "type": "bool",
                "hint": "一些劣质模型容易出现流口水现象，即一直回复相同的内容，此时可拦截此消息",
                "default": true
            },
            "block_words": {
                "description": "拦截关键词",
                "hint": "Bot发的消息中，包含列表中任一关键字时，消息将被拦截",
                "type": "list",
                "default": [
                    "抱歉",
                    "您好",
                    "请稍后",
                    "隐私政策",
                    "作为AI助手",
                    "作为一个AI",
                    "我理解您的感受",
                    "让我来为您解释",
                    "根据相关法规",
                    "很抱歉给您带来不便",
                    "感谢您的理解",
                    "感谢您的耐心等待",
                    "为您带来的不便深表歉意",
                    "如有需要请随时联系",
                    "如果您还有其他问题",
                    "我将尽力为您提供帮助",
                    "希望我的回答对您有所帮助",
                    "该问题需要进一步核实",
                    "请您理解并配合",
                    "暂时无法提供相关信息",
                    "不支持该请求",
                    "不在支持范围内",
                    "该内容暂不可用",
                    "出于安全原因",
                    "出于合规要求",
                    "为保障您的账户安全",
                    "为了保护您的隐私",
                    "根据平台规则",
                    "根据系统检测",
                    "由系统自动生成"
                ]
            }
        }
    },
    "at": {
        "description": "【解析艾特】",
        "type": "object",
        "hint": "将消息中句首的假艾特转换成真艾特, 再按概率保留或移除艾特",
        "default": true,
        "items": {
            "at_str": {
                "description": "转换成字符串艾特",
                "hint": "将解析到的真艾特重新转换成字符串艾特，即 @username xxx (如果发现真艾特与文本间的空格消失了，可以尝试开启此选项，开启后插件会用字符串形式保住空格)",
                "type": "bool",
                "default": true
            },
            "at_prob": {
                "description": "艾特概率",
                "hint": "随机值小于此值 → 必须带 @；随机值大于此值 → 必须不带 @。设为 0 则关闭此功能。请提前关闭Astrbot自动的At功能",
                "type": "float",
                "slider": {
                    "min": 0,
                    "max": 1,
                    "step": 0.001
                },
                "default": 0.01
            }
        }
    },
    "clean": {
        "description": "【文本清理】",
        "type": "object",
        "hint": "清理文本。注意清洗顺序：中括号内容 -> 小括号内容 -> 情绪标签 -> emoji -> 句首字符 -> 句尾字符 -> 整体清洗特殊符号",
        "items": {
            "text_threshold": {
                "description": "文本清理长度阈值",
                "hint": "多少个字符以下时执行文本清理，可以防止对长文本误清理，设为 0 则不执行文本清理",
                "type": "int",
                "slider": {
                    "min": 0,
                    "max": 1000,
                    "step": 50
                },
                "default": 150
            },
            "bracket": {
                "description": "摘除中括号内容",
                "hint": "即摘除消息中的 [...] ",
                "type": "bool",
                "default": true
            },
            "parenthesis": {
                "description": "摘除小括号内容",
                "hint": "即摘除消息中的 (...) 支持半角和全角括号",
                "type": "bool",
                "default": true
            },
            "emotion_tag": {
                "description": "摘除情绪标签",
                "hint": "即摘除消息中的 &&...&&, 若不生效则可能是被其他插件干扰",
                "type": "bool",
                "default": true
            },
            "emoji": {
                "description": "清理emoji",
                "hint": "清理文本中的emoji，对喜欢发emoji的模型有奇效（比如智谱）",
                "type": "bool",
                "default": true
            },
            "lead": {
                "description": "去除句首字符",
                "hint": "对某些喜欢输出前缀的模型有奇效，注意只去除句首字符",
                "type": "list",
                "default": [
                    "print",
                    ":",
                    "："
                ]
            },
            "tail": {
                "description": "去除句尾字符",
                "hint": "对某些喜欢输出句号的模型有奇效，注意只去除句尾字符",
                "type": "list",
                "default": [
                    "。",
                    "."
                ]
            },
            "punctuation": {
                "description": "整体清洗的特殊符号",
                "hint": "填写正则表达式，例如：[#%~], 注意是整句清洗",
                "type": "string",
                "default": "[#%~]"
            }
        }
    },
    "replace": {
        "description": "【文本替换】",
        "type": "object",
        "hint": "替换消息中的特定词，如一些敏感词",
        "items": {
            "words": {
                "description": "替换词对",
                "hint": "格式为：“旧词 新词”，旧词写前面，中间空格隔开，新词写后面(可不填，不填则采用默认替换词)",
                "type": "list",
                "default": [
                    "示例旧词1 示例新词1",
                    "示例旧词2"
                ]
            },
            "default_new_word": {
                "description": "默认替换词",
                "hint": "当替换词对中不填新词时采用的替换词，默认为星号，星号个数等于旧词长度",
                "type": "string",
                "default": "*"
            }
        }
    },
    "tts": {
        "description": "【文转语音】",
        "type": "object",
        "hint": "将消息转为语音。（仅aiocqhttp平台可用）。本插件基于QQ声聊实现TTS, 无需部署, 无需密钥。 开启前, 请先关闭Astrbot自带的TTS功能",
        "items": {
            "group_id": {
                "description": "中转群群号",
                "hint": "必填！ 生成AI语音时, 用中转群中转一次后，可以避免显示AI语音",
                "type": "string",
                "default": ""
            },
            "character": {
                "description": "默认使用的AI语音角色",
                "hint": "将文本转为AI语音时使用",
                "type": "string",
                "options": [
                    "小新（lucy-voice-laibixiaoxin）",
                    "猴哥（lucy-voice-houge）",
                    "四郎（lucy-voice-silang）",
                    "东北老妹儿（lucy-voice-guangdong-f1）",
                    "广西大表哥（lucy-voice-guangxi-m1）",
                    "妲己（lucy-voice-daji）",
                    "霸道总裁（lucy-voice-lizeyan）",
                    "酥心御姐（lucy-voice-suxinjiejie）",
                    "说书先生（lucy-voice-m8）",
                    "憨憨小弟（lucy-voice-male1）",
                    "憨厚老哥（lucy-voice-male3）",
                    "吕布（lucy-voice-lvbu）",
                    "元气少女（lucy-voice-xueling）",
                    "文艺少女（lucy-voice-f37）",
                    "磁性大叔（lucy-voice-male2）",
                    "邻家小妹（lucy-voice-female1）",
                    "低沉男声（lucy-voice-m14）",
                    "傲娇少女（lucy-voice-f38）",
                    "爹系男友（lucy-voice-m101）",
                    "暖心姐姐（lucy-voice-female2）",
                    "温柔妹妹（lucy-voice-f36）",
                    "书香少女（lucy-voice-f34）"
                ],
                "default": "温柔妹妹（lucy-voice-f36）"
            },
            "threshold": {
                "description": "文本长度阈值",
                "hint": "超过此长度的文本不会被转成语音发送",
                "type": "int",
                "slider": {
                    "min": 0,
                    "max": 300,
                    "step": 10
                },
                "default": 50
            },
            "prob": {
                "description": "触发tts的概率",
                "hint": "",
                "type": "float",
                "slider": {
                    "min": 0,
                    "max": 1,
                    "step": 0.01
                },
                "default": 0.1
            }
        }
    },
    "t2i": {
        "description": "【文转图片】",
        "type": "object",
        "hint": "将长文本转为图片。本插件使用 pillowmd 渲染长文本，轻量易用又稳定。如果可以, 开启此功能前, 请先关闭Astrbot的自带的长文本转图功能",
        "items": {
            "threshold": {
                "description": "文本长度阈值",
                "hint": "当消息长度超过此阈值时, 执行长文本处理",
                "type": "int",
                "slider": {
                    "min": 0,
                    "max": 1000,
                    "step": 50
                },
                "default": 150
            },
            "pillowmd_style_dir": {
                "description": "Pillowmd样式文件目录",
                "hint": "支持相对路径和绝对路径, 请用 / 隔开",
                "type": "string",
                "default": "data/plugins/astrbot_plugin_outputpro/t2i_style"
            },
            "auto_page": {
                "description": "自动分页",
                "hint": "开启后，渲染器会按照黄金分割比进行分页",
                "type": "bool",
                "default": true
            },
            "clean_cache": {
                "description": "自动清理缓存",
                "hint": "开启后，重载插件时，会自动清空图片缓存",
                "type": "bool",
                "default": true
            }
        }
    },
    "reply": {
        "description": "【智能引用】",
        "type": "object",
        "hint": "当bot要回复的消息被其他人插嘴时， 引用要回复的消息。",
        "items": {
            "threshold": {
                "description": "引用阈值",
                "hint": "定义当bot要回复的消息被其他人插嘴了几条时，则引用要回复的消息。 设为 0 表示关闭引用功能, 请提前关闭Astrbot自动的Reply功能",
                "type": "int",
                "slider": {
                    "min": 0,
                    "max": 4,
                    "step": 1
                },
                "default": 1
            }
        }
    },
    "forward": {
        "description": "【合并转发】",
        "hint": "将长文本合并转发（仅aiocqhttp平台可用）",
        "type": "object",
        "items": {
            "threshold": {
                "description": "文本长度阈值",
                "hint": "转发长度超过此阈值时执行转发操作",
                "type": "int",
                "slider": {
                    "min": 0,
                    "max": 1000,
                    "step": 50
                },
                "default": 150
            },
            "node_name": {
                "description": "转发节点昵称",
                "hint": "转发消息时使用的昵称，留空则自动获取bot的昵称来显示",
                "type": "string",
                "default": ""
            }
        }
    },
    "recall": {
        "description": "【自动撤回】",
        "hint": "检测发出的消息是否需要撤回，并执行撤回操作（仅aiocqhttp平台可用）",
        "type": "object",
        "items": {
            "keywords": {
                "description": "触发撤回的关键词",
                "hint": "消息中含有这些关键词时触发自动撤回操作",
                "type": "list",
                "default": [
                    "我是",
                    "我叫",
                    "我住在"
                ]
            },
            "delay": {
                "description": "撤回延时",
                "hint": "几秒后撤回消息，单位为秒",
                "type": "int",
                "slider": {
                    "min": 0,
                    "max": 110,
                    "step": 1
                },
                "default": 30
            }
        }
    },
    "split": {
        "description": "【分段回复】",
        "hint": "进行分段回复",
        "type": "object",
        "items": {
            "char_list": {
                "description": "触发分段的字符",
                "hint": "文字后面带这些符号就会分段，（换行是\\n，空格是\\s），如：，。？！\\n",
                "type": "list",
                "default": [
                    "。",
                    "？",
                    "\\n"
                ]
            },
            "smart": {
                "description": "智能分段",
                "hint": "开启后，括号/引号等成对符号内部不会触发分段",
                "type": "bool",
                "default": false
            },
            "max_count": {
                "description": "最大分段数",
                "hint": "超过此数量则不再分段",
                "type": "int",
                "slider": {
                    "min": 1,
                    "max": 5,
                    "step": 1
                },
                "default": 2
            },
            "typing_delay": {
                "description": "每段消息延迟范围（秒）",
                "type": "string",
                "hint": "采用线性插值算法，短文本延迟偏小，长文本延迟偏大",
                "default": "1.5,3.5"
            }
        }
    }
}
